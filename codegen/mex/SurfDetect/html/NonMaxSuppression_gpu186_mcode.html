<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="77,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T1U3">intPoints</span> = NonMaxSuppression_gpu(<span class="var type1" id="S3T5U6">intImage</span>, <span class="var type1" id="S4T6U7">responseMap</span>) <span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="77,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="77,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%   Copyright 2017 The MathWorks, Inc.</span></span></span>
<span class="srcline"><span class="lineno"><a href="77,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="77,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% This function performs non-maximal suppression to filter out the useful</span></span></span>
<span class="srcline"><span class="lineno"><a href="77,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">% interest points in the image. For each octave, we examine a set of 3</span></span></span>
<span class="srcline"><span class="lineno"><a href="77,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">% layers (bottom, middle, top). A threshold is applied to the response of </span></span></span>
<span class="srcline"><span class="lineno"><a href="77,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">% each pixel and it is subsequently compared to its neighboring pixels in a </span></span></span>
<span class="srcline"><span class="lineno"><a href="77,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">% 3x3x3 neighborhood. If an interest point is detected, interpolation is </span></span></span>
<span class="srcline"><span class="lineno"><a href="77,10" id="srcline10">10</a></span><span class="line"><span class="comment">% performed to determine its exact location in scale-space. The output of </span></span></span>
<span class="srcline"><span class="lineno"><a href="77,11" id="srcline11">11</a></span><span class="line"><span class="comment">% this step is an array of interest points</span></span></span>
<span class="srcline"><span class="lineno"><a href="77,12" id="srcline12">12</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="77,13" id="srcline13">13</a></span><span class="line">coder.gpu.kernelfun;</span></span>
<span class="srcline"><span class="lineno"><a href="77,14" id="srcline14">14</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="77,15" id="srcline15">15</a></span><span class="line"><span class="comment">% Mapping responses to octaves based on filter sizes used for each octave</span></span></span>
<span class="srcline"><span class="lineno"><a href="77,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo " id="T70:U4"><span class="var type1" id="S6T70U16">filter_map</span> = <span class="mxinfo " id="T70:U6">[1,2,3,4; 2,4,5,6; 4,6,7,8; 6,8,9,10; 8,10,11,12]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,17" id="srcline17">17</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="77,18" id="srcline18">18</a></span><span class="line"><span class="comment">% Image dimensions</span></span></span>
<span class="srcline"><span class="lineno"><a href="77,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo " id="T43:U7"><span class="var type1" id="S7T43U45">imgDim</span>    = <span class="mxinfo " id="T43:U9">size(<span class="var type1" id="S3T5U48">intImage</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,20" id="srcline20">20</a></span><span class="line"><span class="mxinfo " id="T7:U11"><span class="var type1" id="S9T7U51">i_height</span>  = <span class="mxinfo " id="T7:U13"><span class="var type1" id="S7T43U53">imgDim</span>(1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo " id="T7:U15"><span class="var type1" id="S10T7U57">i_width</span>   = <span class="mxinfo " id="T7:U17"><span class="var type1" id="S7T43U59">imgDim</span>(2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,22" id="srcline22">22</a></span><span class="line"><span class="mxinfo " id="T63:U19"><span class="var type1" id="S11T63U63">ipt</span> = <span class="mxinfo " id="T63:U21">struct(<span class="string">'x'</span>,single(0),<span class="string">'y'</span>,single(0),<span class="string">'scale'</span>,single(0),<span class="string">'orientation'</span>,single(0),<span class="string">'laplacian'</span>,int32(0))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,23" id="srcline23">23</a></span><span class="line">coder.varsize( <span class="string">'intPoints'</span>, [1,2000], [false, true]);</span></span>
<span class="srcline"><span class="lineno"><a href="77,24" id="srcline24">24</a></span><span class="line"><span class="mxinfo " id="T1:U22"><span class="var type1" id="S2T1U104">intPoints</span> = <span class="mxinfo " id="T62:U24">repmat(<span class="var type1" id="S11T63U107">ipt</span>, 1, 2000)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo " id="T3:U26"><span class="var type1" id="S18T3U112">ctr</span> = <span class="mxinfo " id="T3:U28">int32(<span class="mxinfo " id="T7:U29">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,26" id="srcline26">26</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="77,27" id="srcline27">27</a></span><span class="line"><span class="comment">% Iterate over a set of 3 layers within each octave</span></span></span>
<span class="srcline"><span class="lineno"><a href="77,28" id="srcline28">28</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S19T7U118">o</span> = coder.unroll(<span class="mxinfo " id="T7:U31">1</span>:5)</span></span>
<span class="srcline"><span class="lineno"><a href="77,29" id="srcline29">29</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="77,30" id="srcline30">30</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S20T7U128">i</span> = coder.unroll(<span class="mxinfo " id="T7:U33">1</span>:2)</span></span>
<span class="srcline"><span class="lineno"><a href="77,31" id="srcline31">31</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="77,32" id="srcline32">32</a></span><span class="line">        <span class="mxinfo " id="T7:U34"><span class="var type1" id="S21T7U138">b</span> = <span class="mxinfo " id="T7:U36"><span class="var type1" id="S6T70U140">filter_map</span>(<span class="var type1" id="S19T7U141">o</span>,<span class="var type1" id="S20T7U142">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,33" id="srcline33">33</a></span><span class="line">        <span class="mxinfo " id="T7:U40"><span class="var type1" id="S22T7U145">m</span> = <span class="mxinfo " id="T7:U42"><span class="var type1" id="S6T70U147">filter_map</span>(<span class="var type1" id="S19T7U148">o</span>,<span class="var type1" id="S20T7U150">i</span>+1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,34" id="srcline34">34</a></span><span class="line">        <span class="mxinfo " id="T7:U46"><span class="var type1" id="S23T7U154">t</span> = <span class="mxinfo " id="T7:U48"><span class="var type1" id="S6T70U156">filter_map</span>(<span class="var type1" id="S19T7U157">o</span>,<span class="var type1" id="S20T7U159">i</span>+2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,35" id="srcline35">35</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="77,36" id="srcline36">36</a></span><span class="line">        <span class="mxinfo " id="T7:U52"><span class="var type1" id="S24T7U163">b_filter</span>    = <span class="mxinfo " id="T7:U54"><span class="mxinfo " id="T58:U55"><span class="var type1" id="S4T6U166">responseMap</span>(<span class="var type1" id="S21T7U167">b</span>)</span>.filter</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,37" id="srcline37">37</a></span><span class="line">        <span class="mxinfo " id="T7:U58"><span class="var type1" id="S25T7U171">m_filter</span>    = <span class="mxinfo " id="T7:U60"><span class="mxinfo " id="T58:U61"><span class="var type1" id="S4T6U174">responseMap</span>(<span class="var type1" id="S22T7U175">m</span>)</span>.filter</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,38" id="srcline38">38</a></span><span class="line">        <span class="mxinfo " id="T7:U64"><span class="var type1" id="S26T7U179">t_filter</span>    = <span class="mxinfo " id="T7:U66"><span class="mxinfo " id="T58:U67"><span class="var type1" id="S4T6U182">responseMap</span>(<span class="var type1" id="S23T7U183">t</span>)</span>.filter</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,39" id="srcline39">39</a></span><span class="line">        <span class="mxinfo " id="T7:U70"><span class="var type1" id="S27T7U187">t_step</span>      = <span class="mxinfo " id="T7:U72"><span class="mxinfo " id="T58:U73"><span class="var type1" id="S4T6U190">responseMap</span>(<span class="var type1" id="S23T7U191">t</span>)</span>.step</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,40" id="srcline40">40</a></span><span class="line">        <span class="mxinfo " id="T7:U76"><span class="var type1" id="S28T7U195">filterStep</span>  = <span class="mxinfo " id="T7:U78"><span class="var type1" id="S25T7U197">m_filter</span> - <span class="var type1" id="S24T7U198">b_filter</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,41" id="srcline41">41</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="77,42" id="srcline42">42</a></span><span class="line">        <span class="mxinfo " id="T8:U81"><span class="var type1" id="S29T8U201">b_responses</span> = <span class="mxinfo " id="T8:U83"><span class="mxinfo " id="T58:U84"><span class="var type1" id="S4T6U204">responseMap</span>(<span class="var type1" id="S21T7U205">b</span>)</span>.responses</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,43" id="srcline43">43</a></span><span class="line">        <span class="mxinfo " id="T8:U87"><span class="var type1" id="S30T8U209">m_responses</span> = <span class="mxinfo " id="T8:U89"><span class="mxinfo " id="T58:U90"><span class="var type1" id="S4T6U212">responseMap</span>(<span class="var type1" id="S22T7U213">m</span>)</span>.responses</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,44" id="srcline44">44</a></span><span class="line">        <span class="mxinfo " id="T8:U93"><span class="var type1" id="S31T8U217">t_responses</span> = <span class="mxinfo " id="T8:U95"><span class="mxinfo " id="T58:U96"><span class="var type1" id="S4T6U220">responseMap</span>(<span class="var type1" id="S23T7U221">t</span>)</span>.responses</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,45" id="srcline45">45</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="77,46" id="srcline46">46</a></span><span class="line">        <span class="mxinfo " id="T9:U99"><span class="var type1" id="S32T9U225">m_laplacian</span> = <span class="mxinfo " id="T9:U101"><span class="mxinfo " id="T58:U102"><span class="var type1" id="S4T6U228">responseMap</span>(<span class="var type1" id="S22T7U229">m</span>)</span>.laplacian</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,47" id="srcline47">47</a></span><span class="line">        <span class="mxinfo " id="T7:U105"><span class="var type1" id="S33T7U233">m_width</span>     = <span class="mxinfo " id="T7:U107"><span class="mxinfo " id="T58:U108"><span class="var type1" id="S4T6U236">responseMap</span>(<span class="var type1" id="S22T7U237">m</span>)</span>.width</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,48" id="srcline48">48</a></span><span class="line">        <span class="mxinfo " id="T7:U111"><span class="var type1" id="S34T7U241">t_width</span>     = <span class="mxinfo " id="T7:U113"><span class="mxinfo " id="T58:U114"><span class="var type1" id="S4T6U244">responseMap</span>(<span class="var type1" id="S23T7U245">t</span>)</span>.width</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,49" id="srcline49">49</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="77,50" id="srcline50">50</a></span><span class="line">        <span class="comment">% Perform non-maximal suppression</span></span></span>
<span class="srcline"><span class="lineno"><a href="77,51" id="srcline51">51</a></span><span class="line">        [<span class="var type1" id="S35T42U250">keyMatrix</span>, <span class="var type1" id="S36T5U251">result_xi</span>, <span class="var type1" id="S37T5U252">result_xr</span>, <span class="var type1" id="S38T5U253">result_xc</span>]  = <span class="fcn" id="F183N7:B255">NonMaxCalc</span>(<span class="var type1" id="S3T5U256">intImage</span>, <span class="var type1" id="S26T7U257">t_filter</span>, <span class="var type1" id="S27T7U258">t_step</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="77,52" id="srcline52">52</a></span><span class="line">            <span class="var type1" id="S29T8U259">b_responses</span>, <span class="var type1" id="S30T8U260">m_responses</span>, <span class="var type1" id="S31T8U261">t_responses</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="77,53" id="srcline53">53</a></span><span class="line">              </span></span>
<span class="srcline"><span class="lineno"><a href="77,54" id="srcline54">54</a></span><span class="line">        <span class="comment">% Accumulate interest points</span></span></span>
<span class="srcline"><span class="lineno"><a href="77,55" id="srcline55">55</a></span><span class="line">        coder.gpu.kernel;</span></span>
<span class="srcline"><span class="lineno"><a href="77,56" id="srcline56">56</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S40T7U270">c</span> = <span class="mxinfo " id="T7:U128">0</span>:<span class="var type1" id="S10T7U274">i_width</span>-1</span></span>
<span class="srcline"><span class="lineno"><a href="77,57" id="srcline57">57</a></span><span class="line">            coder.gpu.kernel;</span></span>
<span class="srcline"><span class="lineno"><a href="77,58" id="srcline58">58</a></span><span class="line">            <span class="keyword">for</span> <span class="var type1" id="S41T7U284">r</span> = <span class="mxinfo " id="T7:U131">0</span>:<span class="var type1" id="S9T7U288">i_height</span>-1</span></span>
<span class="srcline"><span class="lineno"><a href="77,59" id="srcline59">59</a></span><span class="line">                <span class="keyword">if</span>(<span class="mxinfo " id="T44:U133"><span class="var type1" id="S35T42U294">keyMatrix</span>(<span class="mxinfo " id="T7:U135"><span class="var type1" id="S41T7U296">r</span>+<span class="mxinfo " id="T7:U137">1</span></span>,<span class="mxinfo " id="T7:U138"><span class="var type1" id="S40T7U299">c</span>+<span class="mxinfo " id="T7:U140">1</span></span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="77,60" id="srcline60">60</a></span><span class="line">                    <span class="mxinfo " id="T3:U141"><span class="var type1" id="S42T3U303">ctrVal</span> = coder.nullcopy(int32(0))</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,61" id="srcline61">61</a></span><span class="line">                    <span class="mxinfo " id="T3:U143"><span class="var type1" id="S42T3U313">ctrVal</span> = <span class="mxinfo " id="T3:U145">coder.ceval(<span class="string">'-gpudevicefcn'</span>, <span class="string">'atomicAdd'</span>, coder.ref(<span class="var type1" id="S18T3U324">ctr</span>), <span class="mxinfo " id="T3:U147">int32(<span class="mxinfo " id="T7:U148">1</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,62" id="srcline62">62</a></span><span class="line">                    <span class="keyword">if</span> (<span class="mxinfo " id="T11:U149"><span class="var type1" id="S42T3U332">ctrVal</span> &lt;= <span class="mxinfo " id="T7:U151">2000</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="77,63" id="srcline63">63</a></span><span class="line">                    </span></span>
<span class="srcline"><span class="lineno"><a href="77,64" id="srcline64">64</a></span><span class="line">                    <span class="mxinfo " id="T2:U152"><span class="var type1" id="S43T2U336">xi</span> = <span class="mxinfo " id="T2:U154"><span class="var type1" id="S36T5U338">result_xi</span>(<span class="mxinfo " id="T7:U156"><span class="var type1" id="S41T7U340">r</span>+<span class="mxinfo " id="T7:U158">1</span></span>,<span class="mxinfo " id="T7:U159"><span class="var type1" id="S40T7U343">c</span>+<span class="mxinfo " id="T7:U161">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,65" id="srcline65">65</a></span><span class="line">                    <span class="mxinfo " id="T2:U162"><span class="var type1" id="S44T2U347">xr</span> = <span class="mxinfo " id="T2:U164"><span class="var type1" id="S37T5U349">result_xr</span>(<span class="mxinfo " id="T7:U166"><span class="var type1" id="S41T7U351">r</span>+<span class="mxinfo " id="T7:U168">1</span></span>,<span class="mxinfo " id="T7:U169"><span class="var type1" id="S40T7U354">c</span>+<span class="mxinfo " id="T7:U171">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,66" id="srcline66">66</a></span><span class="line">                    <span class="mxinfo " id="T2:U172"><span class="var type1" id="S45T2U358">xc</span> = <span class="mxinfo " id="T2:U174"><span class="var type1" id="S38T5U360">result_xc</span>(<span class="mxinfo " id="T7:U176"><span class="var type1" id="S41T7U362">r</span>+<span class="mxinfo " id="T7:U178">1</span></span>,<span class="mxinfo " id="T7:U179"><span class="var type1" id="S40T7U365">c</span>+<span class="mxinfo " id="T7:U181">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,67" id="srcline67">67</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="77,68" id="srcline68">68</a></span><span class="line">                    <span class="mxinfo " id="T2:U182"><span class="mxinfo " id="T2:U183"><span class="mxinfo " id="T63:U184"><span class="var type1" id="S2T1U371">intPoints</span>(<span class="var type1" id="S42T3U372">ctrVal</span>)</span>.x</span> = single(<span class="mxinfo " id="T2:U187">(<span class="mxinfo " id="T2:U188"><span class="var type1" id="S40T7U379">c</span> + <span class="var type1" id="S45T2U380">xc</span></span>) * <span class="var type1" id="S27T7U381">t_step</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,69" id="srcline69">69</a></span><span class="line">                    <span class="mxinfo " id="T2:U192"><span class="mxinfo " id="T2:U193"><span class="mxinfo " id="T63:U194"><span class="var type1" id="S2T1U386">intPoints</span>(<span class="var type1" id="S42T3U387">ctrVal</span>)</span>.y</span> = single(<span class="mxinfo " id="T2:U197">(<span class="mxinfo " id="T2:U198"><span class="var type1" id="S41T7U394">r</span> + <span class="var type1" id="S44T2U395">xr</span></span>) * <span class="var type1" id="S27T7U396">t_step</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,70" id="srcline70">70</a></span><span class="line">                    <span class="mxinfo " id="T2:U202"><span class="mxinfo " id="T2:U203"><span class="mxinfo " id="T63:U204"><span class="var type1" id="S2T1U401">intPoints</span>(<span class="var type1" id="S42T3U402">ctrVal</span>)</span>.scale</span> = single(<span class="mxinfo " id="T2:U207">(0.1333) * (<span class="mxinfo " id="T2:U208"><span class="var type1" id="S25T7U411">m_filter</span> + <span class="mxinfo " id="T2:U210"><span class="var type1" id="S43T2U413">xi</span> * <span class="var type1" id="S28T7U414">filterStep</span></span></span>)</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,71" id="srcline71">71</a></span><span class="line">                    <span class="mxinfo " id="T3:U213"><span class="mxinfo " id="T3:U214"><span class="mxinfo " id="T63:U215"><span class="var type1" id="S2T1U419">intPoints</span>(<span class="var type1" id="S42T3U420">ctrVal</span>)</span>.laplacian</span> = <span class="mxinfo " id="T3:U218">int32(<span class="mxinfo " id="T44:U219"><span class="fcn" id="F185N11:B425">getLaplacian</span>(<span class="var type1" id="S32T9U426">m_laplacian</span>, <span class="var type1" id="S33T7U427">m_width</span>, <span class="var type1" id="S41T7U428">r</span>, <span class="var type1" id="S40T7U429">c</span>, <span class="var type1" id="S34T7U430">t_width</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,72" id="srcline72">72</a></span><span class="line">                    <span class="mxinfo " id="T2:U225"><span class="mxinfo " id="T2:U226"><span class="mxinfo " id="T63:U227"><span class="var type1" id="S2T1U435">intPoints</span>(<span class="var type1" id="S42T3U436">ctrVal</span>)</span>.orientation</span> = <span class="mxinfo " id="T2:U230">single(<span class="mxinfo " id="T7:U231">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,73" id="srcline73">73</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="77,74" id="srcline74">74</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="77,75" id="srcline75">75</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="77,76" id="srcline76">76</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="77,77" id="srcline77">77</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="77,78" id="srcline78">78</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="77,79" id="srcline79">79</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="77,80" id="srcline80">80</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="77,81" id="srcline81">81</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="77,82" id="srcline82">82</a></span><span class="line">    <span class="comment">% Return the first 2000 interest points detected</span></span></span>
<span class="srcline"><span class="lineno"><a href="77,83" id="srcline83">83</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T11:U232"><span class="var type1" id="S18T3U444">ctr</span> &lt; <span class="mxinfo " id="T7:U234">2001</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="77,84" id="srcline84">84</a></span><span class="line">        <span class="mxinfo " id="T1:U235"><span class="var type1" id="S2T1U448">intPoints</span> = <span class="mxinfo " id="T71:U237"><span class="var type1" id="S2T1U450">intPoints</span>(<span class="mxinfo " id="T72:U239"><span class="mxinfo " id="T3:U240">1</span>:(<span class="mxinfo " id="T3:U241"><span class="var type1" id="S18T3U455">ctr</span>-<span class="mxinfo " id="T7:U243">1</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="77,85" id="srcline85">85</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="77,86" id="srcline86">86</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="77,87" id="srcline87">87</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="77,88" id="srcline88">88</a></span><span class="line"></span></span>
</pre>
<div class="dead">
<pre class="code">
<span class="srcline"><span class="lineno"><a href="77,89" id="srcline89">89</a></span><span class="line">function resp = getLaplacian(obj_lapl, obj_width, row, column, src_width)</span></span>
<span class="srcline"><span class="lineno"><a href="77,90" id="srcline90">90</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="77,91" id="srcline91">91</a></span><span class="line">if nargin &lt; 5</span></span>
<span class="srcline"><span class="lineno"><a href="77,92" id="srcline92">92</a></span><span class="line">    resp = obj_lapl(row + 1, column + 1);</span></span>
<span class="srcline"><span class="lineno"><a href="77,93" id="srcline93">93</a></span><span class="line">else</span></span>
<span class="srcline"><span class="lineno"><a href="77,94" id="srcline94">94</a></span><span class="line">    scale = floor(obj_width / src_width);</span></span>
<span class="srcline"><span class="lineno"><a href="77,95" id="srcline95">95</a></span><span class="line">    resp = obj_lapl((scale * row) + 1, (scale * column) + 1);</span></span>
<span class="srcline"><span class="lineno"><a href="77,96" id="srcline96">96</a></span><span class="line">end</span></span>
<span class="srcline"><span class="lineno"><a href="77,97" id="srcline97">97</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="77,98" id="srcline98">98</a></span><span class="line">end</span></span>
<span class="srcline"><span class="lineno"><a href="77,99" id="srcline99">99</a></span><span class="line"> </span></span>
</pre>
</div>
</body>
</html>
